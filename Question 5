Question 5:

SELECT REPLACE(ORDER_REF,'PO') ORDER_REF from XXBCM_ORDER_MGT;

select to_char(to_date(ORDER_DATE, 'DD-MM-YYYY'), 'MONTHDD ,YYYY')ORDER_DATE from XXBCM_ORDER_MGT

SELECT
  UPPER(SUPPLIER_NAME) SUPPLIER_NAME 
FROM
  XXBCM_ORDER_MGT



select TO_NUMBER(ORDER_TOTAL_AMOUNT, '99,999,990.00') ORDER_TOTAL_AMOUNT from  XXBCM_ORDER_MGT
 


select listagg(INVOICE_REFERENCE,', ') within group(order by INVOICE_REFERENCE) csv
  from XXBCM_ORDER_MGT; 

Answer below:


SELECT Order Status, REPLACE(ORDER_REF,'PO') ORDER_REF,to_char(to_date(ORDER_DATE, 'DD-MM-YYYY'), 'MONTHDD ,YYYY')ORDER_DATE, UPPER(SUPPLIER_NAME) SUPPLIER_NAME, listagg(INVOICE_REFERENCE,', ') within group(order by INVOICE_REFERENCE) INVOICE_REFERENCE,TO_NUMBER(ORDER_TOTAL_AMOUNT, '99,999,990.00') ORDER_TOTAL_AMOUNT

FROM (select XXBCM_ORDER_MGT.*, rownum rnum from
             (select * from XXBCM_ORDER_MGT ORDER BY ORDER_TOTAL_AMOUNT DESC) ORDER_TOTAL_AMOUNT
      where rownum <= 3 )
WHERE rnum >= 3;


