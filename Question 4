Question 4:

SELECT REPLACE(ORDER_REF,'PO') ORDER_REF from XXBCM_ORDER_MGT;

select to_char(to_date(ORDER_DATE, 'DD-MM-YYYY'), 'MON-DD') from XXBCM_ORDER_MGT
SELECT
  INITCAP(SUPPLIER_NAME) SUPPLIER_NAME 
FROM
  XXBCM_ORDER_MGT
 

select TO_NUMBER(ORDER_TOTAL_AMOUNT, '99,999,990.00') ORDER_TOTAL_AMOUNT from  XXBCM_ORDER_MGT
 
select TO_NUMBER(INVOICE_AMOUNT, '99,999,990.00') INVOICE_AMOUNT from  XXBCM_ORDER_MGT
 

Answer below:


Begin

alter table "XXBCM_ORDER_MGT" add Action Varchar2(100);
INSERT INTO XXBCM_ORDER_MGT(ACTION) Values ('Ok') where INVOICE_STATUS = 'Paid';

INSERT INTO XXBCM_ORDER_MGT(ACTION) Values ('To follow up') where INVOICE_STATUS = 'Pending';

INSERT INTO XXBCM_ORDER_MGT(ACTION) Values ('To verify') where INVOICE_STATUS = '';


SELECT INVOICE_STATUS,ORDER_STATUS,INVOICE_REFERENCE,ACTION,REPLACE(ORDER_REF,'PO') ORDER_REF, to_char(to_date(ORDER_DATE, 'DD-MM-YYYY'), 'MON-DD') ORDER_Date, INITCAP(SUPPLIER_NAME) SUPPLIER_NAME, TO_NUMBER(ORDER_TOTAL_AMOUNT, '99,999,990.00') ORDER_TOTAL_AMOUNT,TO_NUMBER(INVOICE_AMOUNT, '99,999,990.00') INVOICE_AMOUNT

FROM XXBCM_ORDER_MGT;
 

ORDER BY ORDER_DATE  DESC
if  INVOICE_STATUS = 'Paid'
   
THEN ACTION = 'Ok';

   
else if  INVOICE_STATUS = 'Pending'
   THEN ACTION = 'To follow up';
   
   
ELSE
  THEN ACTION = 'To verify';
   

END IF;

END;
